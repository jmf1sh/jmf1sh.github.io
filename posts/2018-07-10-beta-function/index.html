<!doctype html>

<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>jonathan&#39;s blog</title>
    <meta name="description" content="The HTML5 Herald">
    <meta name="author" content="Jonathan Fisher">
    <meta name="generator" content="Hugo 0.81.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://jmf1sh.github.io/css/styles.css" />

    
   <script>
  MathJax = {
    loader: {load: ['[tex]/ams']},
    tex: {
      packages: {'[+]': ['ams']},
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
          x.parentElement.classList += 'has-jax'})
  });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  </head>

  <body>
    <div id="container">
      <header>
        <h1>
          <a href="https://jmf1sh.github.io/">jonathan&rsquo;s blog</a>
        </h1>

        <ul id="social-media">
          

          
          <li><a href="https://www.linkedin.com/in/jonathanfisher10"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
          

          
          <li><a href="https://github.com/jmf1sh"><i class="fa fa-github fa-lg" aria-hidden="true"></i></a></li>
          

          
          <li><a href="https://gitlab.com/jmf1sh"><i class="fa fa-gitlab fa-lg" aria-hidden="true"></i></a></li>
          

          

          
        </ul>
        
        <p><em>mathematics, physics, programming, and machine learning</em></p>
        
      </header>

      
<nav>
    <ul>
        
        <li>
            <a class="" href="https://jmf1sh.github.io/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Posts</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://jmf1sh.github.io/about/">
                <i class="fa-li fa  fa-lg"></i><span>About</span>
            </a>
        </li>
        
    </ul>
</nav>

      <main>




<article>

    <h1>Euler beta function and Dirichlet distribution</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2018-07-10T00:00:00Z">Jul 10, 2018</time>
        </li>
        

        

        <li>2 minutes read</li>
    </ul>
</aside>

    

    <p>Let&rsquo;s remind ourselves how about the Euler beta function, defined as</p>
<p>$$ B(x,y) = \int_0^1 t^{x-1} (1-t)^{y-1} dt. $$</p>
<p>First, we will express $$B(x,y)$$ in terms of the more familiar Gamma function,
defined as</p>
<p>$$ \Gamma(x) = \int_0^\infty t^{x-1} e^{-t} dt. $$</p>
<p>First, we have</p>
<p>$$ \Gamma(x) \Gamma(y) = \int_0^\infty \int_0^\infty s^{x-1} t^{y-1} e^{-s-t} ds dt $$</p>
<p>Now, suppose we have a multinomial distribution over $$k$$ classes with probabilites $$p_1, \ldots, p_k$$. In for $n$ trials, the probability of observing $$k_i$$ instances of class $$i$$ is given by</p>
<p>$$ P(n_1, \ldots, n_k) = {n \choose n_1, \ldots, n_k} \prod_i p_i^{n_i} $$</p>
<p>Suppose that initially the probabilities $p_i$ are unknown, and we wish to infer them from
a given observation of $n$ trials. Using a conjugate prior, we can take the unknown probabilites
to follow the Dirichlet distribution</p>
<p>$$ P(p_1, \ldots, p_k) = C_\alpha \prod_i p_i^{\alpha_i-1} $$</p>
<p>(where the normalization constant $$C_\alpha$$ can be computed explicitly in terms of the
generalized beta function, or equivalently in terms of the Gamma function).
Using Bayes' theorem we have</p>
<p>$$
\begin{align*}
P(\alpha | n_1, \ldots, n_k) &amp;= C P(n_1, \ldots, n_k | \alpha) P(\alpha) \\\<br>
&amp;= C' \prod_i p_i^{n_i+\alpha_i-1}
\end{align*}
$$</p>
<p>This gives a new Dirichlet distribution with $$\alpha_i$$ replaced by $$\alpha_i+n_i$$.
Taking expectation values of the posterior we have</p>
<p>$$E[p_i] = \frac{n_i+\alpha_i}{n+\sum_i \alpha_i}$$.</p>
<p>Taking the Jeffreys prior $$\alpha_i = 1/2$$, we have finally</p>
<p>$$E[p_i] = \frac{n_i+1/2}{n+n/2}$$.</p>
<p>Note that this assigns a non-zero value to $$p_i$$ even in the case that $$n_i = 0$$!</p>
<p>For comparison, consider taking instead the estimate from maximum likelihood. We have</p>
<p>$$ \log L(p, n) = C + \sum_i n_i \log p_i. $$</p>
<p>Maximizing subject to the constraints $$\sum_i p_i = 1$$, we have</p>
<p>$$ n_i / p_i = \lambda $$</p>
<p>for some Lagrange multiplier $$\lambda$$, for all $$i$$. Hence we obtain</p>
<p>$$ p_i = n_i / n $$</p>
<p>and note that in this case, we assign zero probability to any class which is not observed.
So we see that the expected distribution derived though Bayesian inference is more
conservative than maximum likelihood, in the sense that zero probabilities are assigned
only in the limit of infinitely many trials.</p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://jmf1sh.github.io/posts/2018-01-14-reinforcement-learning/"><i class="fa fa-chevron-circle-left"></i> Introduction to Reinforcement Learning</a>
        </li>
        
        
        <li>
            <a href="https://jmf1sh.github.io/posts/2018-12-24-vae/">Variational autoencoders <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
    
        <section class="comments-block">
      <button id="show-comments" style="display: none;"><i class="fa fa-comments-o"></i> Add/View Comments</button>
</section>

<section id="disqus_thread"></section>

<script>
      (function () {
            
            
            if (window.location.hostname == "localhost")
                  return;

            var disqus_loaded = false;
            var disqus_shortname = 'jmf1sh';
            var disqus_button = document.getElementById("show-comments");

            disqus_button.style.display = "";
            disqus_button.addEventListener("click", disqus, false);

            function disqus() {

                  if (!disqus_loaded) {
                        disqus_loaded = true;

                        var e = document.createElement("script");
                        e.type = "text/javascript";
                        e.async = true;
                        e.src = "//" + disqus_shortname + ".disqus.com/embed.js";
                        (document.getElementsByTagName("head")[0] ||
                              document.getElementsByTagName("body")[0])
                        .appendChild(e);

                        
                        document.getElementById("show-comments").style.display = "none";
                  }
            }

            
            var hash = window.location.hash.substr(1);
            if (hash.length > 8) {
                  if (hash.substring(0, 8) == "comment-") {
                        disqus();
                  }
            }

            
            if (/bot|google|baidu|bing|msn|duckduckgo|slurp|yandex/i.test(navigator.userAgent)) {
                  disqus();
            }
      })();
</script>
    





</main>
    <footer>
        <h6> |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://jmf1sh.github.io/index.xml">Subscribe</a></h6>
    </footer>
</div>
<script src="https://jmf1sh.github.io/js/scripts.js"></script>

</body>

</html>
